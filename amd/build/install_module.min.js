define(["jquery","core/str","core/modal_factory","core/modal_events"],function(a,b,c,d){return{init:function(){var b=function(){a(".modlib-sections .dropdown-item").on("click",function(){var b=a("#courseid").val(),d=a(this).attr("value");if(console.log("course ID = "+b),console.log("command = "+d),0===a('input[class="module"]:checked').length)c.create({type:c.types.CANCEL,title:"No Module selected",body:"Please select at least one module to install."}).then(function(a){a.show()});else{a(".modlib-modal").show();var e=a(this).attr("value"),f=a(this).html();console.log("Install into section "+e+" -> "+f);var g=a('input[class="module"]:checked').length;a('input[class="module"]:checked').each(function(){var b={};b.id=a(this).val(),b.cmid=a(this).attr("cmid"),b.name=a(this).attr("name"),b.type=a(this).attr("module_type"),console.log('=> checked module "'+b.name+'" (ID '+b.id+") type = "+b.type),console.log(window.location.host),console.log(window.location.pathname);var c=window.location.pathname,d=c.split("/");console.log("-----"),d.shift();var f=window.location.protocol+"//"+window.location.host+"/"+d.shift()+"/blocks/modlib/execute.php";console.log(f),console.log("-----"),d=a.ajax({url:f,type:"POST",data:{sectionid:e,cmid:b.cmid,moduleid:b.id,type:b.type},success:function(c){""!==c?(console.log("Execution result:\n"+c),a("#modlib-modal-msg").html(c)):console.warn("Unsupported module type for installation: "+b.type+"!\n"),--g||(a(".modlib-modal").hide(),location.reload())},error:function(b){a(".modlib-modal").hide(),console.error(b)}})})}})},d=function(){a(".test").on("click",function(){console.log("test!")})},e=function(){b(),d()};a(document).ready(function(){console.log("=================< modlib/install_module >================="),e(),a("#modlib-spinner-modal").hide(),a("tr.module").css("cursor","pointer")})}}});