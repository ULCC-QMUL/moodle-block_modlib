define(["jquery","core/config","core/str","core/modal_factory","core/modal_events"],function(a,b,c,d){return{init:function(){var c=function(){a(".modlib-sections .dropdown-item").on("click",function(){if(0===a('input[class="module"]:checked').length)d.create({type:d.types.CANCEL,title:"No Module selected",body:"Please select at least one module to install."}).then(function(a){a.show()});else{a(".modlib-modal").show();var c=a(this).attr("value"),e=a('input[class="module"]:checked').length;a('input[class="module"]:checked').each(function(){var d={};d.id=a(this).val(),d.cmid=a(this).attr("cmid"),d.name=a(this).attr("name"),d.type=a(this).attr("module_type");var f=b.wwwroot+"/blocks/modlib/execute.php";a.ajax({url:f,type:"POST",data:{sectionid:c,cmid:d.cmid,moduleid:d.id,type:d.type},success:function(b){a("#modlib-modal-msg").html(b),--e||location.reload()},error:function(b){a(".modlib-modal").hide(),alert(b)}})})}})},e=function(){c()};a(document).ready(function(){e(),a(".module_row").on("click",function(){0!==a('input[class="module"]:checked').length?a("#target_topic_btn").removeClass("disabled"):a("#target_topic_btn").addClass("disabled")}),a("#modlib-spinner-modal").hide(),a("tr.module").css("cursor","pointer")})}}});